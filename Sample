import ActivityKit
import CloudKit

var currentActivity: Activity<YourActivityAttributes>?

func fetchRecordAndUpdateActivity(recordID: CKRecord.ID) {
    let database = CKContainer.default().publicCloudDatabase
    
    database.fetch(withRecordID: recordID) { record, error in
        if let record = record, error == nil {
            // Assume the record has a field named "name" that you want to display
            let updatedName = record["name"] as? String ?? "Default Name"
            updateLiveActivity(name: updatedName)
        } else {
            print("Error fetching record: \(error?.localizedDescription ?? "Unknown error")")
        }
    }
}

func updateLiveActivity(name: String) {
    guard let activity = currentActivity else { return }

    let updatedContentState = YourActivityAttributes.ContentState(message: name)
    Task {
        await activity.update(using: updatedContentState)
    }
}
